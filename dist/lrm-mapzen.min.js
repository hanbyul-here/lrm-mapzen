!function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){return o(e[i][1][r]||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}({1:[function(require,module,exports){void 0!==module&&(module.exports=function(url,callback,cors){var sent=!1;if(void 0===window.XMLHttpRequest)return callback(Error("Browser not supported"));if(void 0===cors){var m=url.match(/^\s*https?:\/\/[^\/]*/);cors=m&&m[0]!==location.protocol+"//"+location.hostname+(location.port?":"+location.port:"")}var x=new window.XMLHttpRequest;if(cors&&!("withCredentials"in x)){x=new window.XDomainRequest;var original=callback;callback=function(){if(sent)original.apply(this,arguments);else{var that=this,args=arguments;setTimeout(function(){original.apply(that,args)},0)}}}function loaded(){var status;void 0===x.status||(200<=(status=x.status)&&status<300||304===status)?callback.call(x,null,x):callback.call(x,x,null)}return"onload"in x?x.onload=loaded:x.onreadystatechange=function(){4===x.readyState&&loaded()},x.onerror=function(evt){callback.call(this,evt||!0,null),callback=function(){}},x.onprogress=function(){},x.ontimeout=function(evt){callback.call(this,evt,null),callback=function(){}},x.onabort=function(evt){callback.call(this,evt,null),callback=function(){}},x.open("GET",url,!0),x.send(null),sent=!0,x})},{}],2:[function(require,module,exports){"use strict";var polyline={};function py2_round(value){return Math.floor(Math.abs(value)+.5)*Math.sign(value)}function encode(current,previous,factor){var coordinate=(current=py2_round(current*factor))-(previous=py2_round(previous*factor));coordinate<<=1,current-previous<0&&(coordinate=~coordinate);for(var output="";32<=coordinate;)output+=String.fromCharCode(63+(32|31&coordinate)),coordinate>>=5;return output+=String.fromCharCode(coordinate+63)}function flipped(coords){for(var flipped=[],i=0;i<coords.length;i++)flipped.push(coords[i].slice().reverse());return flipped}polyline.decode=function(str,precision){for(var latitude_change,index=0,lat=0,lng=0,coordinates=[],shift=0,result=0,byte=null,factor=Math.pow(10,precision||5);index<str.length;){for(byte=null,result=shift=0;result|=(31&(byte=str.charCodeAt(index++)-63))<<shift,shift+=5,32<=byte;);for(latitude_change=1&result?~(result>>1):result>>1,shift=result=0;result|=(31&(byte=str.charCodeAt(index++)-63))<<shift,shift+=5,32<=byte;);lat+=latitude_change,lng+=1&result?~(result>>1):result>>1,coordinates.push([lat/factor,lng/factor])}return coordinates},polyline.encode=function(coordinates,precision){if(!coordinates.length)return"";for(var factor=Math.pow(10,precision||5),output=encode(coordinates[0][0],0,factor)+encode(coordinates[0][1],0,factor),i=1;i<coordinates.length;i++){var a=coordinates[i],b=coordinates[i-1];output+=encode(a[0],b[0],factor),output+=encode(a[1],b[1],factor)}return output},polyline.fromGeoJSON=function(geojson,precision){if(geojson&&"Feature"===geojson.type&&(geojson=geojson.geometry),!geojson||"LineString"!==geojson.type)throw new Error("Input must be a GeoJSON LineString");return polyline.encode(flipped(geojson.coordinates),precision)},polyline.toGeoJSON=function(str,precision){return{type:"LineString",coordinates:flipped(polyline.decode(str,precision))}},"object"==typeof module&&module.exports&&(module.exports=polyline)},{}],3:[function(require,module,exports){(function(global){var L="undefined"!=typeof window?window.L:void 0!==global?global.L:null,MapzenRouter=require("./mapzenRouter"),MapzenLine=require("./mapzenLine"),MapzenFormatter=require("./mapzenFormatter"),MapzenWaypoint=require("./mapzenWaypoint");L.Routing=L.Routing||{},L.routing=L.routing||{},L.Routing.Mapzen=MapzenRouter,L.Routing.MapzenLine=MapzenLine,L.Routing.MapzenFormatter=MapzenFormatter,L.Routing.MapzenWaypoint=MapzenWaypoint,L.routing.mapzen=function(n,e){return new MapzenRouter(n,e)},L.routing.mapzenLine=function(n,e){return new MapzenLine(n,e)},L.routing.mapzenFormatter=function(n){return new MapzenFormatter(n)},L.routing.mapzenWaypoint=function(n,e,t){return new MapzenWaypoint(n,e,t)},L.Routing.mapzen=L.routing.mapzen,L.Routing.mapzenLine=L.routing.mapzenLine,L.Routing.mapzenFormatter=L.routing.mapzenFormatter,L.Routing.mapzenWaypoint=L.routing.mapzenWaypoint}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./mapzenFormatter":4,"./mapzenLine":5,"./mapzenRouter":6,"./mapzenWaypoint":7}],4:[function(require,module,exports){(function(global){!function(){"use strict";var t="undefined"!=typeof window?window.L:void 0!==global?global.L:null;module.exports=t.Class.extend({options:{units:"metric",unitNames:{meters:"m",kilometers:"km",yards:"yd",miles:"mi",hours:"h",minutes:"mÃ­n",seconds:"s"},language:"en",roundingSensitivity:1,distanceTemplate:"{value} {unit}"},initialize:function(e){t.setOptions(this,e)},formatDistance:function(e){var n,a=this.options.unitNames;return n="imperial"===this.options.units?(e*=1e3,1e3<=(e/=1.609344)?{value:this._round(e)/1e3,unit:a.miles}:{value:this._round(e/1.76),unit:a.yards}):{value:1<=e?e:1e3*e,unit:1<=e?a.kilometers:a.meters},t.Util.template(this.options.distanceTemplate,n)},_round:function(t){var e=Math.pow(10,(Math.floor(t/this.options.roundingSensitivity)+"").length-1),r=5<Math.floor(t/e)?e:e/2;return Math.round(t/r)*r},formatTime:function(t){return 86400<t?Math.round(t/3600)+" h":3600<t?Math.floor(t/3600)+" h "+Math.round(t%3600/60)+" min":300<t?Math.round(t/60)+" min":60<t?Math.floor(t/60)+" min"+(t%60!=0?" "+t%60+" s":""):t+" s"},formatInstruction:function(t,e){return t.instruction},getIconName:function(t,e){switch(t.type){case 0:return"kNone";case 1:return"kStart";case 2:return"kStartRight";case 3:return"kStartLeft";case 4:return"kDestination";case 5:return"kDestinationRight";case 6:return"kDestinationLeft";case 7:return"kBecomes";case 8:return"kContinue";case 9:return"kSlightRight";case 10:return"kRight";case 11:return"kSharpRight";case 12:return"kUturnRight";case 13:return"kUturnLeft";case 14:return"kSharpLeft";case 15:return"kLeft";case 16:return"kSlightLeft";case 17:return"kRampStraight";case 18:return"kRampRight";case 19:return"kRampLeft";case 20:return"kExitRight";case 21:return"kExitLeft";case 22:return"kStayStraight";case 23:return"kStayRight";case 24:return"kStayLeft";case 25:return"kMerge";case 26:return"kRoundaboutEnter";case 27:return"kRoundaboutExit";case 28:return"kFerryEnter";case 29:return"kFerryExit";case 30:case 31:case 32:case 33:case 34:case 35:case 36:return t.edited_travel_type?"kTransit"+this._getCapitalizedName(t.edited_travel_type):"kTransit"}},_getInstructionTemplate:function(t,e){return t.instruction+" "+t.length},_getCapitalizedName:function(t){return t.charAt(0).toUpperCase()+t.slice(1)}})}()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],5:[function(require,module,exports){(function(global){!function(){"use strict";var t="undefined"!=typeof window?window.L:void 0!==global?global.L:null;module.exports=t.LayerGroup.extend({includes:t.Evented?t.Evented.prototype:t.Mixin.Events,options:{styles:[{color:"white",opacity:.8,weight:8},{color:"#06a6d4",opacity:1,weight:6}],missingRouteStyles:[{color:"black",opacity:.15,weight:8},{color:"white",opacity:.6,weight:6},{color:"gray",opacity:.8,weight:4,dashArray:"7,12"}],addWaypoints:!0,extendToWaypoints:!0,missingRouteTolerance:10},initialize:function(i,e){if(t.setOptions(this,e),t.LayerGroup.prototype.initialize.call(this,e),this._route=i,this.options.extendToWaypoints&&this._extendToWaypoints(),i.subRoutes)for(var o=0;o<i.subRoutes.length;o++)i.subRoutes[o].styles||(i.subRoutes[o].styles=this.options.styles),this._addSegment(i.subRoutes[o].coordinates,i.subRoutes[o].styles,this.options.addWaypoints);else this._addSegment(i.coordinates,this.options.styles,this.options.addWaypoints)},addTo:function(t){return t.addLayer(this),this},getBounds:function(){return t.latLngBounds(this._route.coordinates)},_findWaypointIndices:function(){var t,i=this._route.inputWaypoints,e=[];for(t=0;t<i.length;t++)e.push(this._findClosestRoutePoint(i[t].latLng));return e},_findClosestRoutePoint:function(t){var i,e,o,n=Number.MAX_VALUE;for(e=this._route.coordinates.length-1;0<=e;e--)(o=t.distanceTo(this._route.coordinates[e]))<n&&(i=e,n=o);return i},_extendToWaypoints:function(){var i,e,o,n=this._route.inputWaypoints,s=this._getWaypointIndices();for(i=0;i<n.length;i++)e=n[i].latLng,o=t.latLng(this._route.coordinates[s[i]]),e.distanceTo(o)>this.options.missingRouteTolerance&&this._addSegment([e,o],this.options.missingRouteStyles)},_addSegment:function(i,e,o){var n,s;for(n=0;n<e.length;n++)s=t.polyline(i,e[n]),this.addLayer(s),o&&s.on("mousedown",this._onLineTouched,this)},_findNearestWpBefore:function(t){for(var i=this._getWaypointIndices(),e=i.length-1;0<=e&&i[e]>t;)e--;return e},_onLineTouched:function(t){var i=this._findNearestWpBefore(this._findClosestRoutePoint(t.latlng));this.fire("linetouched",{afterIndex:i,latlng:t.latlng})},_getWaypointIndices:function(){return this._wpIndices||(this._wpIndices=this._route.waypointIndices||this._findWaypointIndices()),this._wpIndices}})}()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],6:[function(require,module,exports){(function(global){!function(){"use strict";var t="undefined"!=typeof window?window.L:void 0!==global?global.L:null,e=require("@mapbox/corslite"),n=require("@mapbox/polyline"),i=require("./mapzenWaypoint");module.exports=t.Class.extend({options:{serviceUrl:"https://valhalla.mapzen.com/route?",timeout:3e4},initialize:function(e,n){for(var i in t.Util.setOptions(this,n),this.options.routingOptions={},n)"serviceUrl"===i||"timeout"===i||(this.options.routingOptions[i]=n[i]);-1<this.options.serviceUrl.indexOf("//valhalla.mapzen.com")&&console.warn("Mapzen is shutting down its services including Turn-by-turn. Read more at https://mapzen.com/blog/shutdown"),this._accessToken=e},route:function(n,o,r,s){var a,l,u,p,c=!1,g=[],h=t.extend(this.options.routingOptions,s);for(a=this.buildRouteUrl(n,h),l=setTimeout(function(){c=!0,o.call(r||o,{status:-1,message:"Time out."})},this.options.timeout),p=0;p<n.length;p++)u=n[p],g.push(new i(t.latLng(u.latLng),u.name||"",u.options||{}));return e(a,t.bind(function(t,e){var n;clearTimeout(l),c||(t?(console.log("Error : "+t.response),o.call(r||o,{status:t.status,message:t.response})):(n=JSON.parse(e.responseText),this._routeDone(n,g,h,o,r)))},this),!0),this},_routeDone:function(e,i,o,r,s){var a,l;if(s=s||r,0===e.trip.status){for(var u,p=[],c=[],g=0,h=0;h<e.trip.legs.length;h++){for(var m=n.decode(e.trip.legs[h].shape,6),v=0;v<m.length;v++)c.push(t.latLng(m[v][0],m[v][1]));for(var f=0;f<e.trip.legs[h].maneuvers.length;f++){var _=e.trip.legs[h].maneuvers[f];_.distance=e.trip.legs[h].maneuvers[f].length,_.index=g+e.trip.legs[h].maneuvers[f].begin_shape_index,p.push(_)}"multimodal"===o.costing&&(p=this._unifyTransitManeuver(p)),g+=e.trip.legs[h].maneuvers[e.trip.legs[h].maneuvers.length-1].begin_shape_index}l=this._toWaypoints(i,e.trip.locations),"multimodal"==o.costing&&(u=this._getSubRoutes(e.trip.legs)),a=[{name:this._trimLocationKey(i[0].latLng)+" , "+this._trimLocationKey(i[i.length-1].latLng),unit:e.trip.units,costing:o.costing,coordinates:c,subRoutes:u,instructions:p,summary:e.trip.summary?this._convertSummary(e.trip.summary):[],inputWaypoints:i,outputWaypoints:l,actualWaypoints:l,waypointIndices:this._clampIndices([0,e.trip.legs[0].maneuvers.length],c)}],r.call(s,null,a)}else r.call(s,{status:e.status,message:e.status_message})},_unifyTransitManeuver:function(t){for(var e,n=t,i=0;i<n.length;i++)if(30==n[i].type){e=n[i].travel_type;break}for(var o=0;o<n.length;o++)29<n[o].type&&(n[o].edited_travel_type=e);return n},_getSubRoutes:function(t){for(var e=[],i=0;i<t.length;i++){for(var o,r=n.decode(t[i].shape,6),s=[],a=0;a<t[i].maneuvers.length;a++){var l=t[i].maneuvers[a],u=l.travel_type;u===o&&31!==l.type||(0<l.begin_shape_index&&s.push(l.begin_shape_index),l.transit_info?e.push({travel_type:u,styles:this._getPolylineColor(l.transit_info.color)}):e.push({travel_type:u})),o=u}s.push(r.length);for(var p=0,c=0;c<s.length;c++){var g=[],h=0;c!==s.length-1&&(h=1);for(var m=p;m<s[c]+h;m++)g.push(r[m]);var v=g;p=s[c],e[c].coordinates=v}}return e},_getPolylineColor:function(t){return[187<.299*(t>>16&255)+.587*(t>>8&255)+.114*(t>>0&255)?{color:"#000",opacity:.8,weight:8}:{color:"#fff",opacity:.8,weight:8},{color:"#"+(16777216|16777215&t).toString(16).substring(1,7).toUpperCase(),opacity:1,weight:6}]},_toWaypoints:function(e,n){var o,r=[];for(o=0;o<n.length;o++){var s={};for(var a in n[o])"lat"!==a&&"lon"!==a&&(s[a]=n[o][a]);r.push(new i(t.latLng([n[o].lat,n[o].lon]),null,s))}return r},buildRouteUrl:function(e,n){for(var i=[],o=0;o<e.length;o++){var r={lat:e[o].latLng.lat,lon:e[o].latLng.lng};for(var s in e[o].options)e[o].options[s]&&(r[s]=e[o].options[s]);i.push(r)}var a=t.extend(n,{locations:i}),l=JSON.stringify(a);return this.options.serviceUrl+"json="+l+"&api_key="+this._accessToken},_locationKey:function(t){return t.lat+","+t.lng},_trimLocationKey:function(t){return t.lat,t.lng,Math.floor(1e3*t.lat)/1e3+" , "+Math.floor(1e3*t.lng)/1e3},_convertSummary:function(t){return{totalDistance:t.length,totalTime:t.time}},_convertInstructions:function(t){var e,n,i,o,r=[];for(e=0;e<t.length;e++)n=t[e],i=this._drivingDirectionType(n[0]),o=n[0].split("-"),i&&r.push({type:i,distance:n[2],time:n[4],road:n[1],direction:n[6],exit:1<o.length?o[1]:void 0,index:n[3]});return r},_clampIndices:function(t,e){var n,i=e.length-1;for(n=0;n<t.length;n++)t[n]=Math.min(i,Math.max(t[n],0))}})}()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./mapzenWaypoint":7,"@mapbox/corslite":1,"@mapbox/polyline":2}],7:[function(require,module,exports){(function(global){!function(){"use strict";var l="undefined"!=typeof window?window.L:void 0!==global?global.L:null;module.exports=l.Class.extend({options:{type:null,name:null,haeding:null,heading_tolerance:null,street:null,way_id:null,minimum_reachability:null,radius:null},initialize:function(n,i,t){l.Util.setOptions(this,t),this.latLng=l.latLng(n),this.name=i}})}()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[3,4,5,6,7]);
